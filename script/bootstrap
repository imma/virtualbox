#!/usr/bin/env bash

function bootstrap {
  local shome="$(cd -P -- "${BASH_SOURCE%/*}/.." && pwd -P)"
  source "$shome/script/profile"

  local force=
  case "${1:-}" in
    force)
      shift
      force='--force '
      ;;
  esac

  case "$(uname -s)" in
    Darwin)
      brew cask install ${force}virtualbox
      brew cask install ${force}virtualbox-extension-pack
      ;;
    Linux)
      sudo apt-key add "$shome/etc/virtualbox.gpg"
      sudo apt-key add "$shome/etc/virtualbox_2016.gpg"
      source /etc/lsb-release
      echo "deb http://download.virtualbox.org/virtualbox/debian ${DISTRIB_CODENAME} contrib" | sudo tee /etc/apt/sources.list.d/virtualbox.list
      sudo -E aptitude update
      sudo -E aptitude install -y dkms virtualbox-5.1
      ;;
  esac
}

bootstrap
